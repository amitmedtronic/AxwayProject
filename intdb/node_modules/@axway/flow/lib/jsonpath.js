const jsonpath = require('@axway/jsonpath');

/**
 * Get a value by JSONPath.
 * @param {string} key - The jsonpath being queried.
 * @param {*} obj - The object being searched.
 * @return {*} The first result of the query.
 */
const getByJsonPath = (key, obj) => {
	let val;

	// Specifically use typeof here. "instanceof Object" will return
	// false if obj was created in a different context and data will
	// not be able to be selected.
	if (obj === null || typeof obj !== 'object') {
		if (key === '$') {
			val = obj;
		}
	} else {
		val = jsonpath.query(obj, key);
		val = val.length > 0 ? val[0] : undefined;
	}

	return val;
};

module.exports = {
	getByJsonPath
};
