const debug = require('debug');
const { convertOASSchemaToDraft06 } = require('../utils/schema');

const log = debug('oas-flow-node');

function addParameter(
	sdk, parameter, parameterMap, options = { convertSchema: true }) {

	let { schema } = parameter;
	if (options.convertSchema) {
		schema = convertOASSchemaToDraft06(parameter.schema);
	}

	const propertyName = parameterMap.register(parameter.name, {
		location: parameter.in,
		name: parameter.name
	});
	schema.title = schema.title || propertyName;

	log('parameter property-name:', propertyName);
	sdk.parameter(propertyName, schema, {
		required: !!parameter.required
	});
}

module.exports = addParameter;
