const expPlusJSON = /\+?json$/;
const appJSON = 'application/json';

function sortContentTypes(a, b) {
	if (a === b) {
		return 0;
	}
	// sort application/json before other content types
	if (a === appJSON && b !== appJSON) {
		return -1;
	} else if (a !== appJSON && b === appJSON) {
		return 1;
	}

	// then prefer application/*+json
	const pa = a.match(expPlusJSON);
	const pb = b.match(expPlusJSON);
	if (pa && !pb) {
		return -1;
	} else if (!pa && pb) {
		return 1;
	}
	// if they are both +json or neither are then sort alphabetically.
	return a.localeCompare(b);
}

function sortResponses(a, b) {
	const sa = a.statusCode - 0;
	const sb = b.statusCode - 0;
	if (Number.isNaN(sa) && !Number.isNaN(sb)) {
		return -1;
	}
	if (!Number.isNaN(sa) && Number.isNaN(sb)) {
		return 1;
	}
	return (sa === sb) ? 0 : sa > sb ? 1 : -1;
}

module.exports = {
	sortContentTypes,
	sortResponses
};
